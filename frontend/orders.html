<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>My Orders - AAGAM</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; font-family:'Inter',sans-serif; }
    body { background:#f8f9fa; min-height:100vh; }
    .header {
      background:#fff;
      padding:14px 16px;
      font-size:18px;
      font-weight:700;
      box-shadow:0 2px 6px rgba(0,0,0,.08);
      position:sticky;
      top:0;
      z-index:100;
      text-align:center;
    }
    .container { max-width:800px; margin:0 auto; padding:20px; }
    .orders-header {
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:30px;
      flex-wrap:wrap;
      gap:15px;
    }
    .orders-header h1 { color:#333; font-size:24px; }
    .orders-filter {
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    .filter-btn {
      padding:8px 16px;
      border:1px solid #ddd;
      background:white;
      border-radius:6px;
      cursor:pointer;
      font-weight:500;
      transition:all 0.3s ease;
    }
    .filter-btn.active {
      background:#ff3269;
      color:white;
      border-color:#ff3269;
    }
    .order-card {
      background:white;
      border-radius:12px;
      padding:20px;
      margin-bottom:20px;
      box-shadow:0 2px 10px rgba(0,0,0,0.1);
      border:1px solid #eee;
    }
    .order-header {
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:15px;
      flex-wrap:wrap;
      gap:10px;
    }
    .order-id {
      font-weight:600;
      color:#ff3269;
    }
    .order-status {
      padding:6px 14px;
      border-radius:20px;
      font-size:13px;
      font-weight:600;
      text-transform:uppercase;
    }
    .status-delivered { background:#d4edda; color:#155724; }
    .status-outfordelivery { background:#fff3cd; color:#856404; }
    .status-processing { background:#d1ecf1; color:#0c5460; }
    .status-cancelled { background:#f8d7da; color:#721c24; }
    .order-date { color:#666; font-size:14px; margin-bottom:15px; }
    .order-items { margin-bottom:15px; }
    .order-item {
      display:flex;
      justify-content:space-between;
      padding:8px 0;
      border-bottom:1px solid #f5f5f5;
      font-size:14px;
    }
    .item-name { font-weight:500; }
    .order-total {
      text-align:right;
      font-weight:700;
      color:#ff3269;
      font-size:18px;
      margin-top:15px;
    }
    .order-actions {
      display:flex;
      gap:12px;
      margin-top:16px;
      flex-wrap:wrap;
    }
    .action-btn {
      padding:10px 20px;
      border:1px solid #ddd;
      background:white;
      border-radius:8px;
      cursor:pointer;
      font-weight:600;
      transition:all 0.2s;
    }
    .action-btn.primary {
      background:#ff3269;
      color:white;
      border-color:#ff3269;
    }
    .action-btn:hover { opacity:0.9; transform:translateY(-1px); }
    .empty-orders {
      text-align:center;
      padding:100px 20px;
      color:#666;
    }
    .empty-orders .icon { font-size:90px; margin-bottom:24px; color:#ddd; }
    .empty-orders h2 { color:#333; margin-bottom:12px; }
    .shop-btn {
      display:inline-block;
      padding:14px 32px;
      background:#ff3269;
      color:white;
      text-decoration:none;
      border-radius:10px;
      font-weight:600;
      margin-top:16px;
    }
    .modal {
      display:none;
      position:fixed;
      inset:0;
      background:rgba(0,0,0,0.6);
      z-index:1000;
      align-items:center;
      justify-content:center;
      padding:20px;
    }
    .modal-content {
      background:#fff;
      border-radius:16px;
      width:100%;
      max-width:520px;
      max-height:90vh;
      overflow-y:auto;
      box-shadow:0 10px 40px rgba(0,0,0,0.3);
    }
    .modal-header {
      padding:16px 20px;
      border-bottom:1px solid #eee;
      display:flex;
      justify-content:space-between;
      align-items:center;
      position:sticky;
      top:0;
      background:#fff;
      z-index:10;
    }
    .close-btn {
      background:none;
      border:none;
      font-size:32px;
      cursor:pointer;
      color:#777;
    }
    .modal-body { padding:20px; }
    .timeline {
      margin-top:20px;
      padding-left:20px;
      border-left:2px solid #eee;
      position:relative;
    }
    .timeline-item {
      position:relative;
      margin-bottom:24px;
    }
    .timeline-item:last-child { margin-bottom:0; }
    .timeline-dot {
      width:16px;
      height:16px;
      background:#ddd;
      border-radius:50%;
      position:absolute;
      left:-25px;
      top:4px;
      border:3px solid #fff;
      box-shadow:0 0 0 4px #eee;
    }
    .timeline-item.completed .timeline-dot {
      background:#ff3269;
      box-shadow:0 0 0 4px #ffebee;
    }
    .timeline-item.active .timeline-dot {
      background:#ff3269;
      animation:pulse 2s infinite;
    }
    .timeline-title { font-weight:600; margin-bottom:4px; }
    .timeline-time { color:#666; font-size:13px; }
    @keyframes pulse {
      0% { box-shadow:0 0 0 0 rgba(255,50,105,0.4); }
      70% { box-shadow:0 0 0 10px rgba(255,50,105,0); }
      100% { box-shadow:0 0 0 0 rgba(255,50,105,0); }
    }
    @media (max-width:768px) {
      .orders-header { flex-direction:column; align-items:flex-start; }
      .order-actions { flex-direction:column; gap:10px; }
      .action-btn { width:100%; }
    }
  </style>
</head>
<body>

<div class="header">My Orders</div>

<div class="container">
  <div class="orders-header">
    <h1>My Orders</h1>
    <div class="orders-filter">
      <button class="filter-btn active" data-filter="all">All</button>
      <button class="filter-btn" data-filter="active">Active</button>
      <button class="filter-btn" data-filter="completed">Completed</button>
    </div>
  </div>

  <div id="ordersList"></div>

  <!-- Empty State -->
  <div class="empty-orders" id="emptyOrders" style="display:none;">
    <div class="icon">ðŸ“¦</div>
    <h2>No orders found</h2>
    <p>When you place your first order, it will appear here</p>
    <a href="index.html" class="shop-btn">Start Shopping</a>
  </div>
</div>

<!-- Order Details Modal -->
<div class="modal" id="orderModal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>Order Details</h3>
      <button class="close-btn" onclick="closeModal()">Ã—</button>
    </div>
    <div class="modal-body" id="orderDetails"></div>
  </div>
</div>

<script>
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Load Orders from localStorage
function getOrders() {
  return JSON.parse(localStorage.getItem('aagamOrders')) || [];
}

let currentFilter = 'all';

document.addEventListener('DOMContentLoaded', () => {
  loadOrders();
  setupFilters();
});

function setupFilters() {
  document.querySelectorAll('.filter-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      currentFilter = btn.dataset.filter;
      loadOrders();
    });
  });
}

function loadOrders() {
  const ordersList = document.getElementById('ordersList');
  const emptyOrders = document.getElementById('emptyOrders');
  const orders = getOrders();

  let filtered = orders;
  if (currentFilter === 'active') {
    filtered = orders.filter(o => !['delivered', 'cancelled'].includes(o.status));
  } else if (currentFilter === 'completed') {
    filtered = orders.filter(o => o.status === 'delivered');
  }

  if (filtered.length === 0) {
    ordersList.innerHTML = '';
    emptyOrders.style.display = 'block';
    return;
  }

  emptyOrders.style.display = 'none';
  ordersList.innerHTML = '';

  filtered.forEach(order => {
    const card = document.createElement('div');
    card.className = 'order-card';
    card.innerHTML = `
      <div class="order-header">
        <span class="order-id">#${order.id}</span>
        <span class="order-status status-${order.status}">${order.status.toUpperCase()}</span>
      </div>
      <div class="order-date">Ordered on ${order.date}</div>
      <div class="order-items">
        ${order.items.slice(0, 3).map(item => `
          <div class="order-item">
            <div>
              <span class="item-name">${item.name}</span><br>
              <span class="item-details">Qty: ${item.qty || 1}</span>
            </div>
            <span>â‚¹${(item.price * (item.qty || 1)).toFixed(0)}</span>
          </div>
        `).join('')}
        ${order.items.length > 3 ? `<p style="color:#666;margin-top:8px;">+ ${order.items.length - 3} more items</p>` : ''}
      </div>
      <div class="order-total">Total: â‚¹${order.total}</div>
      <div class="order-actions">
        <button class="action-btn" onclick="viewOrderDetails('${order.id}')">View Details</button>
        <button class="action-btn primary" onclick="reorder('${order.id}')">Reorder</button>
      </div>
    `;
    ordersList.appendChild(card);
  });
}

function viewOrderDetails(id) {
  const orders = getOrders();
  const order = orders.find(o => o.id === id);
  if (!order) return;

  const timelineHtml = order.timeline.map(step => {
    const isActive = step.title.toLowerCase().includes('out for delivery') && order.status === 'shipped';
    const isCompleted = step.completed;
    return `
      <div class="timeline-item ${isCompleted ? 'completed' : ''} ${isActive ? 'active' : ''}">
        <div class="timeline-dot"></div>
        <div class="timeline-content">
          <div class="timeline-title">${step.title}</div>
          <div class="timeline-time">${step.time}</div>
        </div>
      </div>
    `;
  }).join('');

  const itemsHtml = order.items.map(item => `
    <div class="order-item">
      <span>${item.name} Ã— ${item.qty || 1}</span>
      <span>â‚¹${(item.price * (item.qty || 1)).toFixed(0)}</span>
    </div>
  `).join('');

  document.getElementById('orderDetails').innerHTML = `
    <div style="margin-bottom:24px;">
      <strong>Order ID:</strong> ${order.id}<br>
      <strong>Date:</strong> ${order.date}<br>
      <strong>Status:</strong> <span class="order-status status-${order.status}">${order.status}</span><br>
      <strong>Delivery Address:</strong> ${order.address || 'Not available'}
    </div>
    <div style="margin-bottom:24px;">
      <h4>Items Ordered</h4>
      ${itemsHtml}
      <div class="order-total" style="margin-top:12px;">Total: â‚¹${order.total}</div>
    </div>
    <div>
      <h4>Order Timeline</h4>
      <div class="timeline">${timelineHtml}</div>
    </div>
  `;

  document.getElementById('orderModal').style.display = 'flex';
}

function closeModal() {
  document.getElementById('orderModal').style.display = 'none';
}

function reorder(id) {
  const orders = getOrders();
  const order = orders.find(o => o.id === id);
  if (!order) return;

  let cart = JSON.parse(localStorage.getItem('aagamCart')) || [];
  order.items.forEach(item => {
    const existing = cart.find(i => i.name === item.name);
    if (existing) {
      existing.qty = (existing.qty || 1) + (item.qty || 1);
    } else {
      cart.push({ ...item });
    }
  });

  localStorage.setItem('aagamCart', JSON.stringify(cart));
  alert(`Items from order #${id} added to cart!`);
  window.location.href = 'cart.html';
}

window.onclick = function(e) {
  if (e.target.id === 'orderModal') closeModal();
};
</script>
</body>
</html>
